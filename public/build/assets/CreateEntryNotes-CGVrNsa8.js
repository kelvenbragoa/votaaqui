import{s as te}from"./index-CZ0HvYoh.js";import{s as oe}from"./index-CVMdGOu9.js";import{s as se}from"./index-kPko3y8E.js";import{s as le}from"./index-6eZmd0W_.js";import{s as ae}from"./index-LQiIxZP6.js";import{s as re}from"./index-BkvNc1Xl.js";import{s as ie}from"./index-C0fELCZ3.js";import{x as ne,r as a,y as de,o as ue,c as F,b as t,d as s,w as i,z as l,A as y,s as _,t as u,B as ce,m as me,F as pe,q as fe,l as S,h as c}from"./app-Bf6Mdg56.js";import{u as ve}from"./vee-validate-D8sAoENI.js";import"./moment-C5S46NFB.js";import{c as ye,a as g}from"./index.esm-CQT6nZnd.js";import{d as _e}from"./debounce-BMmXVQ06.js";import"./index-CU_juRZx.js";import"./index-0kBO3NFd.js";import"./index-DDFDSg2h.js";import"./index-BzjCUeEh.js";import"./index-BtG1CJaU.js";import"./index-AjkHMlqC.js";import"./index-DC-ua2C7.js";import"./index-Cvp8XU8V.js";import"./index-EdjGFngG.js";import"./index-l4qq919w.js";import"./index-NwUwLz2D.js";import"./index-DKdzVXmM.js";import"./index-BwgjIyDn.js";import"./index-Da0pbdgN.js";import"./index-DJTbxXZU.js";import"./index-ja5bTmGS.js";const ge={key:0,class:"flex flex-col md:flex-row gap-12 min-h-screen items-center justify-center"},be={class:"w-full"},xe={class:"flex flex-col gap-4 text-center"},ke={key:1,class:"flex flex-col md:flex-row gap-12"},he={class:"w-full"},Ve={class:"card flex flex-col gap-4"},Se={class:"w-full"},Ce={class:"flex flex-col gap-2"},we={id:"reference-help",class:"p-error"},De={class:"flex flex-col gap-2"},$e={id:"document_reference-help",class:"p-error"},qe={class:"flex flex-col gap-2"},Be={id:"serie-help",class:"p-error"},Ne={class:"flex flex-col gap-2"},Ue={id:"stock_supplier_id-help",class:"p-error"},Ee={class:"flex flex-col gap-2"},Fe={id:"stock_center_id-help",class:"p-error"},ct={__name:"CreateEntryNotes",setup(Qe){const C=fe(),m=ne();a(null);const b=a(!0),w=a(!1),D=a(!1);let Q=a(null);const T=a(""),P=a(null),W=a(1);a(15),a(0);const $=a(!1);a(null);const f=a(!1),z=a([]),L=a([]),x=a([]),G=ye({reference:g().required().trim().label("Codigo"),stock_center_id:g().required().trim().label("CentrodeStock"),document_reference:g().required().trim().label("Documente"),serie:g().required().trim().label("serie"),stock_supplier_id:g().required().trim().label("CentrodeStock")}),{defineField:v,handleSubmit:H,resetForm:Te,errors:d,setErrors:K}=ve({validationSchema:G}),[k]=v("stock_center_id"),[q]=v("document_reference"),[B]=v("serie"),[N]=v("stock_supplier_id"),[U]=v("reference"),R=a();function j(){C&&C.back()}const A=()=>{$.value=!1},E=H(n=>{const e=x.value.map(r=>({id:r.id,product_id:r.product.id,stock_center_id:r.stock_center_id,quantity:r.transferQuantity}));n.stockcenterproducts=e,R.value!=null&&(n.image=R.value),f.value=!0,axios.post("/api/entrynotes",n,{headers:{"Content-Type":"multipart/form-data"}}).then(r=>{C.back(),m.add({severity:"success",summary:"Successo",detail:"Criado com sucesso",life:3e3})}).catch(r=>{f.value=!1,m.add({severity:"error",summary:"Erro",detail:`${r.response.data.message}`,life:3e3}),r.response.data.errors&&K(r.response.data.errors)}).finally(()=>{f.value=!1})}),I=async(n=1)=>{axios.get("/api/entrynotes/create",{params:{query:T.value}}).then(e=>{z.value=e.data.stockcenters,L.value=e.data.suppliers,b.value=!1}).catch(e=>{b.value=!1,m.add({severity:"error",summary:`${e}`,detail:"Message Detail",life:3e3}),j()})},O=()=>{w.value=!0,axios.delete(`/api/entrynotes/${Q.value}`).then(()=>{P.value.data=P.value.data.filter(n=>n.id!==Q.value),A(),m.add({severity:"success",summary:"Sucesso",detail:"Sucesso ao apagar",life:3e3})}).catch(n=>{m.add({severity:"error",summary:"Erro",detail:`${n}`,life:3e3}),w.value=!1}).finally(()=>{w.value=!1})},J=n=>{D.value=!0,axios.get(`/api/auxiliar-product/${n}`).then(e=>{x.value=e.data.stockcenterproducts,x.value.forEach(r=>{r.transferQuantity=0}),D.value=!1}).catch(e=>{m.add({severity:"error",summary:`${e}`,detail:"Message Detail",life:3e3}),D.value=!1})},X=_e(()=>{I(W.value)},300);return de(T,X),ue(()=>{I()}),(n,e)=>{const r=ie,h=re,V=ae,M=le,p=se,Y=oe,Z=te;return S(),F(pe,null,[b.value?(S(),F("div",ge,[t("div",be,[t("div",xe,[s(r,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"}),e[8]||(e[8]=t("p",null,"Por Favor Aguarde...",-1))])])])):(S(),F("div",ke,[t("div",he,[t("div",Ve,[t("div",Se,[s(h,{label:"Voltar",class:"mr-2 mb-2",onClick:j},{default:i(()=>e[9]||(e[9]=[t("i",{class:"pi pi-angle-left"},null,-1),c(" Voltar")])),_:1})]),e[19]||(e[19]=t("div",{class:"font-semibold text-xl"},"Nota de Entrada de Stock",-1)),e[20]||(e[20]=t("small",{class:"p-error"},"Os campos marcados * sao considerados campos obrigatorios.",-1)),t("form",{onSubmit:e[6]||(e[6]=(...o)=>l(E)&&l(E)(...o))},[t("div",Ce,[e[10]||(e[10]=t("label",{for:"reference"},"REF",-1)),s(V,{modelValue:l(U),"onUpdate:modelValue":e[0]||(e[0]=o=>y(U)?U.value=o:null),id:"reference",placeholder:"Referencia",class:_({"p-invalid":l(d).reference}),type:"text"},null,8,["modelValue","class"]),t("small",we,u(l(d).reference),1)]),t("div",De,[e[11]||(e[11]=t("label",{for:"document_reference"},"Documento",-1)),s(V,{modelValue:l(q),"onUpdate:modelValue":e[1]||(e[1]=o=>y(q)?q.value=o:null),id:"document_reference",placeholder:"Documento",class:_({"p-invalid":l(d).document_reference}),type:"text"},null,8,["modelValue","class"]),t("small",$e,u(l(d).document_reference),1)]),t("div",qe,[e[12]||(e[12]=t("label",{for:"serie"},"Serie",-1)),s(V,{modelValue:l(B),"onUpdate:modelValue":e[2]||(e[2]=o=>y(B)?B.value=o:null),id:"serie",placeholder:"Serie",class:_({"p-invalid":l(d).serie}),type:"text"},null,8,["modelValue","class"]),t("small",Be,u(l(d).serie),1)]),t("div",Ne,[e[13]||(e[13]=t("label",{for:"stock_supplier_id"},"Supplier",-1)),s(M,{modelValue:l(N),"onUpdate:modelValue":e[3]||(e[3]=o=>y(N)?N.value=o:null),options:L.value,optionLabel:"name",optionValue:"id",placeholder:"Selecionar",class:_({"p-invalid":l(d).stock_supplier_id})},null,8,["modelValue","options","class"]),t("small",Ue,u(l(d).stock_supplier_id),1)]),t("div",Ee,[e[14]||(e[14]=t("label",{for:"stock_center_id"},"Centro de Sock ",-1)),s(M,{modelValue:l(k),"onUpdate:modelValue":e[4]||(e[4]=o=>y(k)?k.value=o:null),options:z.value,optionLabel:"name",optionValue:"id",placeholder:"Selecionar",class:_({"p-invalid":l(d).stock_center_id}),onChange:e[5]||(e[5]=o=>J(l(k)))},null,8,["modelValue","options","class"]),t("small",Fe,u(l(d).stock_center_id),1)]),e[18]||(e[18]=t("hr",null,null,-1)),s(Y,{value:x.value,dataKey:"id",rowHover:!0,loading:b.value,showGridlines:""},{header:i(()=>e[15]||(e[15]=[])),empty:i(()=>e[16]||(e[16]=[c("Nenhuma registro encontrado. ")])),loading:i(()=>e[17]||(e[17]=[c(" Carregando, por favor espere. ")])),default:i(()=>[s(p,{header:"ID",style:{"min-width":"12rem"}},{body:i(({data:o})=>[c(u(o.id),1)]),_:1}),s(p,{header:"Nome",style:{"min-width":"12rem"}},{body:i(({data:o})=>[c(u(o.product.name),1)]),_:1}),s(p,{header:"Categoria",style:{"min-width":"12rem"}},{body:i(({data:o})=>[c(u(o.product.category.name),1)]),_:1}),s(p,{header:"SubCategoria",style:{"min-width":"12rem"}},{body:i(({data:o})=>[c(u(o.product.subcategory.name),1)]),_:1}),s(p,{header:"Stock Atual",style:{"min-width":"12rem"}},{body:i(({data:o})=>[c(u(o.quantity),1)]),_:1}),s(p,{header:"Quantidade",dataType:"number",style:{"min-width":"10rem"}},{body:i(({data:o})=>[s(V,{modelValue:o.transferQuantity,"onUpdate:modelValue":ee=>o.transferQuantity=ee,placeholder:"Quantidade",min:0,max:o.quantity,type:"number",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue","max"])]),_:1})]),_:1},8,["value","loading"]),s(h,{label:"Submeter",class:"mr-2 mb-2 mt-2",onClick:l(E),disabled:f.value},null,8,["onClick","disabled"]),f.value?(S(),ce(r,{key:0,style:{width:"35px",height:"35px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"})):me("",!0)],32)])])])),s(Z,{header:"Confirmação",visible:$.value,"onUpdate:visible":e[7]||(e[7]=o=>$.value=o),style:{width:"350px"},modal:!0},{footer:i(()=>[s(h,{label:"Não",icon:"pi pi-times",onClick:A,class:"p-button-text"}),s(h,{label:"Sim",icon:"pi pi-check",onClick:O,class:"p-button-text",autofocus:""})]),default:i(()=>[e[21]||(e[21]=t("div",{class:"flex align-items-center justify-content-center"},[t("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}}),t("span",null,"Tem certeza que deseja proceder?")],-1))]),_:1},8,["visible"])],64)}}};export{ct as default};
