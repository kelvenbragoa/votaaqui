import{s as te}from"./index-CnszjjtJ.js";import{s as oe}from"./index-CDqNT4St.js";import{s as se}from"./index-Ck0pw5nd.js";import{s as le}from"./index-LzfBnFcQ.js";import{s as ae}from"./index-ChNyJrCk.js";import{s as re}from"./index-DzcF86oG.js";import{s as ie}from"./index-o3qi-ec1.js";import{u as ne,r as a,w as de,o as ue,c as F,a as t,b as s,e as i,g as l,l as _,n as y,t as u,j as ce,i as me,F as pe,k as fe,f as V,d as c}from"./app-DrVY5UIB.js";import{u as ve}from"./vee-validate-DiISrGOR.js";import{d as _e}from"./moment-CQ1ixRO1.js";import{c as ye,a as g}from"./index.esm-DpER4CkV.js";import"./index-BnfWDIPH.js";import"./index-OUojj5W6.js";import"./index--EEhPIfl.js";import"./index-BCrV5xA7.js";import"./index-CTfp0x3z.js";import"./index-DytjaMpk.js";import"./index-BAE_mEon.js";import"./index-CZNYUL1o.js";import"./index-DuQbNip_.js";import"./index-QlbquBzF.js";import"./index-BYCe9Ecl.js";import"./index-3epIZWS7.js";import"./index-BovvML42.js";import"./index-CpYWlWMi.js";import"./index-pZUdUnUT.js";import"./index-BO4gTK7C.js";import"./_commonjsHelpers-Cpj98o6Y.js";const ge={key:0,class:"flex flex-col md:flex-row gap-12 min-h-screen items-center justify-center"},xe={class:"w-full"},be={class:"flex flex-col gap-4 text-center"},ke={key:1,class:"flex flex-col md:flex-row gap-12"},he={class:"w-full"},Se={class:"card flex flex-col gap-4"},Ve={class:"w-full"},Ce={class:"flex flex-col gap-2"},we={id:"reference-help",class:"p-error"},De={class:"flex flex-col gap-2"},$e={id:"document_reference-help",class:"p-error"},qe={class:"flex flex-col gap-2"},Be={id:"serie-help",class:"p-error"},Ne={class:"flex flex-col gap-2"},Ue={id:"stock_supplier_id-help",class:"p-error"},Ee={class:"flex flex-col gap-2"},Fe={id:"stock_center_id-help",class:"p-error"},ct={__name:"CreateExitNotes",setup(Qe){const C=fe(),m=ne();a(null);const x=a(!0),w=a(!1),D=a(!1);let Q=a(null);const T=a(""),P=a(null),W=a(1);a(15),a(0);const $=a(!1);a(null);const f=a(!1),j=a([]),L=a([]),b=a([]),G=ye({reference:g().required().trim().label("Codigo"),stock_center_id:g().required().trim().label("CentrodeStock"),document_reference:g().required().trim().label("Documente"),serie:g().required().trim().label("serie"),stock_supplier_id:g().required().trim().label("CentrodeStock")}),{defineField:v,handleSubmit:H,resetForm:Te,errors:d,setErrors:K}=ve({validationSchema:G}),[k]=v("stock_center_id"),[q]=v("document_reference"),[B]=v("serie"),[N]=v("stock_supplier_id"),[U]=v("reference"),R=a();function z(){C&&C.back()}const I=()=>{$.value=!1},E=H(n=>{const e=b.value.map(r=>({id:r.id,product_id:r.product.id,stock_center_id:r.stock_center_id,quantity:r.transferQuantity}));n.stockcenterproducts=e,R.value!=null&&(n.image=R.value),f.value=!0,axios.post("/api/exitnotes",n,{headers:{"Content-Type":"multipart/form-data"}}).then(r=>{C.back(),m.add({severity:"success",summary:"Successo",detail:"Criado com sucesso",life:3e3})}).catch(r=>{f.value=!1,m.add({severity:"error",summary:"Erro",detail:`${r.response.data.message}`,life:3e3}),r.response.data.errors&&K(r.response.data.errors)}).finally(()=>{f.value=!1})}),M=async(n=1)=>{axios.get("/api/exitnotes/create",{params:{query:T.value}}).then(e=>{j.value=e.data.stockcenters,L.value=e.data.suppliers,x.value=!1}).catch(e=>{x.value=!1,m.add({severity:"error",summary:`${e}`,detail:"Message Detail",life:3e3}),z()})},O=()=>{w.value=!0,axios.delete(`/api/exitnotes/${Q.value}`).then(()=>{P.value.data=P.value.data.filter(n=>n.id!==Q.value),I(),m.add({severity:"success",summary:"Sucesso",detail:"Sucesso ao apagar",life:3e3})}).catch(n=>{m.add({severity:"error",summary:"Erro",detail:`${n}`,life:3e3}),w.value=!1}).finally(()=>{w.value=!1})},J=n=>{D.value=!0,axios.get(`/api/auxiliar-product/${n}`).then(e=>{b.value=e.data.stockcenterproducts,b.value.forEach(r=>{r.transferQuantity=0}),D.value=!1}).catch(e=>{m.add({severity:"error",summary:`${e}`,detail:"Message Detail",life:3e3}),D.value=!1})},X=_e(()=>{M(W.value)},300);return de(T,X),ue(()=>{M()}),(n,e)=>{const r=ie,h=re,S=ae,A=le,p=se,Y=oe,Z=te;return V(),F(pe,null,[x.value?(V(),F("div",ge,[t("div",xe,[t("div",be,[s(r,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"}),e[8]||(e[8]=t("p",null,"Por Favor Aguarde...",-1))])])])):(V(),F("div",ke,[t("div",he,[t("div",Se,[t("div",Ve,[s(h,{label:"Voltar",class:"mr-2 mb-2",onClick:z},{default:i(()=>e[9]||(e[9]=[t("i",{class:"pi pi-angle-left"},null,-1),c(" Voltar")])),_:1})]),e[19]||(e[19]=t("div",{class:"font-semibold text-xl"},"Nota de Saída de Stock",-1)),e[20]||(e[20]=t("small",{class:"p-error"},"Os campos marcados * sao considerados campos obrigatorios.",-1)),t("form",{onSubmit:e[6]||(e[6]=(...o)=>l(E)&&l(E)(...o))},[t("div",Ce,[e[10]||(e[10]=t("label",{for:"reference"},"REF",-1)),s(S,{modelValue:l(U),"onUpdate:modelValue":e[0]||(e[0]=o=>_(U)?U.value=o:null),id:"reference",placeholder:"Referencia",class:y({"p-invalid":l(d).reference}),type:"text"},null,8,["modelValue","class"]),t("small",we,u(l(d).reference),1)]),t("div",De,[e[11]||(e[11]=t("label",{for:"document_reference"},"Documento",-1)),s(S,{modelValue:l(q),"onUpdate:modelValue":e[1]||(e[1]=o=>_(q)?q.value=o:null),id:"document_reference",placeholder:"Documento",class:y({"p-invalid":l(d).document_reference}),type:"text"},null,8,["modelValue","class"]),t("small",$e,u(l(d).document_reference),1)]),t("div",qe,[e[12]||(e[12]=t("label",{for:"serie"},"Serie",-1)),s(S,{modelValue:l(B),"onUpdate:modelValue":e[2]||(e[2]=o=>_(B)?B.value=o:null),id:"serie",placeholder:"Serie",class:y({"p-invalid":l(d).serie}),type:"text"},null,8,["modelValue","class"]),t("small",Be,u(l(d).serie),1)]),t("div",Ne,[e[13]||(e[13]=t("label",{for:"stock_supplier_id"},"Supplier",-1)),s(A,{modelValue:l(N),"onUpdate:modelValue":e[3]||(e[3]=o=>_(N)?N.value=o:null),options:L.value,optionLabel:"name",optionValue:"id",placeholder:"Selecionar",class:y({"p-invalid":l(d).stock_supplier_id})},null,8,["modelValue","options","class"]),t("small",Ue,u(l(d).stock_supplier_id),1)]),t("div",Ee,[e[14]||(e[14]=t("label",{for:"stock_center_id"},"Centro de Sock ",-1)),s(A,{modelValue:l(k),"onUpdate:modelValue":e[4]||(e[4]=o=>_(k)?k.value=o:null),options:j.value,optionLabel:"name",optionValue:"id",placeholder:"Selecionar",class:y({"p-invalid":l(d).stock_center_id}),onChange:e[5]||(e[5]=o=>J(l(k)))},null,8,["modelValue","options","class"]),t("small",Fe,u(l(d).stock_center_id),1)]),e[18]||(e[18]=t("hr",null,null,-1)),s(Y,{value:b.value,dataKey:"id",rowHover:!0,loading:x.value,showGridlines:""},{header:i(()=>e[15]||(e[15]=[])),empty:i(()=>e[16]||(e[16]=[c("Nenhuma registro encontrado. ")])),loading:i(()=>e[17]||(e[17]=[c(" Carregando, por favor espere. ")])),default:i(()=>[s(p,{header:"ID",style:{"min-width":"12rem"}},{body:i(({data:o})=>[c(u(o.id),1)]),_:1}),s(p,{header:"Nome",style:{"min-width":"12rem"}},{body:i(({data:o})=>[c(u(o.product.name),1)]),_:1}),s(p,{header:"Categoria",style:{"min-width":"12rem"}},{body:i(({data:o})=>[c(u(o.product.category.name),1)]),_:1}),s(p,{header:"SubCategoria",style:{"min-width":"12rem"}},{body:i(({data:o})=>[c(u(o.product.subcategory.name),1)]),_:1}),s(p,{header:"Stock Atual",style:{"min-width":"12rem"}},{body:i(({data:o})=>[c(u(o.quantity),1)]),_:1}),s(p,{header:"Quantidade",dataType:"number",style:{"min-width":"10rem"}},{body:i(({data:o})=>[s(S,{modelValue:o.transferQuantity,"onUpdate:modelValue":ee=>o.transferQuantity=ee,placeholder:"Quantidade",min:0,max:o.quantity,type:"number",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue","max"])]),_:1})]),_:1},8,["value","loading"]),s(h,{label:"Submeter",class:"mr-2 mb-2 mt-2",onClick:l(E),disabled:f.value},null,8,["onClick","disabled"]),f.value?(V(),ce(r,{key:0,style:{width:"35px",height:"35px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"})):me("",!0)],32)])])])),s(Z,{header:"Confirmação",visible:$.value,"onUpdate:visible":e[7]||(e[7]=o=>$.value=o),style:{width:"350px"},modal:!0},{footer:i(()=>[s(h,{label:"Não",icon:"pi pi-times",onClick:I,class:"p-button-text"}),s(h,{label:"Sim",icon:"pi pi-check",onClick:O,class:"p-button-text",autofocus:""})]),default:i(()=>[e[21]||(e[21]=t("div",{class:"flex align-items-center justify-content-center"},[t("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}}),t("span",null,"Tem certeza que deseja proceder?")],-1))]),_:1},8,["visible"])],64)}}};export{ct as default};
