import{s as J}from"./index-CZ0HvYoh.js";import{s as K}from"./index-lHd1N6GA.js";import{s as X}from"./index-6eZmd0W_.js";import{s as Y}from"./index-LQiIxZP6.js";import{s as Z}from"./index-BkvNc1Xl.js";import{s as ee}from"./index-C0fELCZ3.js";import{x as ae,r as o,y as oe,o as le,c as $,b as a,d as i,w,z as l,A as f,s as v,t as g,B as se,m as te,F as ie,q as re,l as b,h as ne}from"./app-Bf6Mdg56.js";import{u as de}from"./vee-validate-D8sAoENI.js";import"./moment-C5S46NFB.js";import{c as ue,a as _}from"./index.esm-CQT6nZnd.js";import{d as ce}from"./debounce-BMmXVQ06.js";import"./index-CU_juRZx.js";import"./index-0kBO3NFd.js";import"./index-DJTbxXZU.js";import"./index-BswoqAwm.js";import"./index-sZHwhbys.js";import"./index-DDFDSg2h.js";import"./index-Cvp8XU8V.js";import"./index-ja5bTmGS.js";import"./index-NwUwLz2D.js";const me={key:0,class:"flex flex-col md:flex-row gap-12 min-h-screen items-center justify-center"},pe={class:"w-full"},fe={class:"flex flex-col gap-4 text-center"},ve={key:1,class:"flex flex-col md:flex-row gap-12"},ge={class:"w-full"},be={class:"card flex flex-col gap-4"},_e={class:"w-full"},xe={class:"flex flex-col gap-2"},ye={id:"name-help",class:"p-error"},Ve={class:"flex flex-col gap-2"},he={id:"price-help",class:"p-error"},ke={class:"flex flex-col gap-2"},Se={id:"category_id-help",class:"p-error"},Ce={class:"flex flex-col gap-2"},Pe={id:"sub_category_id-help",class:"p-error"},Be={class:"flex flex-col gap-2"},Ke={__name:"CreateProducts",setup(De){const x=re(),n=ae();o(null);const y=o(!0),V=o(!1);let U=o(null);const A=o(""),h=o(null),I=o(1);o(15),o(0);const k=o(!1),F=o(null),N=o(null),S=o(null),d=o(!1),M=ue({category_id:_().required().trim().label("Categoria"),name:_().required().trim().label("Name"),price:_().required().trim().label("Preco"),sub_category_id:_().required().trim().label("Name")}),{defineField:u,handleSubmit:R,resetForm:$e,errors:r,setErrors:W}=de({validationSchema:M}),[c]=u("category_id"),[C]=u("sub_category_id"),[P]=u("price"),[B]=u("name"),m=o();function q(){x&&x.back()}const z=()=>{k.value=!1},O=s=>{m.value=s.files[0],console.log(m.value)},D=R(s=>{m.value!=null&&(s.image=m.value),d.value=!0,axios.post("/api/products",s,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{x.back(),n.add({severity:"success",summary:"Successo",detail:"Produto criado com sucesso",life:3e3})}).catch(e=>{d.value=!1,n.add({severity:"error",summary:"Erro}",detail:`${e.response.data.message}`,life:3e3}),e.response.data.errors&&W(e.response.data.errors)}).finally(()=>{d.value=!1})}),T=async(s=1)=>{axios.get("/api/products/create",{params:{query:A.value}}).then(e=>{h.value=e.data.categories,F.value=e.data.categories,N.value=e.data.sub_categories,y.value=!1}).catch(e=>{y.value=!1,n.add({severity:"error",summary:`${e}`,detail:"Message Detail",life:3e3}),q()})},Q=()=>{V.value=!0,axios.delete(`/api/products/${U.value}`).then(()=>{h.value.data=h.value.data.filter(s=>s.id!==U.value),z(),n.add({severity:"success",summary:"Sucesso",detail:"Sucesso ao apagar",life:3e3})}).catch(s=>{n.add({severity:"error",summary:"Erro",detail:`${s}`,life:3e3}),V.value=!1}).finally(()=>{V.value=!1})};return ce(()=>{T(I.value)},300),oe(c,s=>{s?S.value=N.value.filter(e=>e.category_id===s):S.value=[]}),le(()=>{T()}),(s,e)=>{const E=ee,p=Z,L=Y,j=X,G=K,H=J;return b(),$(ie,null,[y.value?(b(),$("div",me,[a("div",pe,[a("div",fe,[i(E,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"}),e[6]||(e[6]=a("p",null,"Por Favor Aguarde...",-1))])])])):(b(),$("div",ve,[a("div",ge,[a("div",be,[a("div",_e,[i(p,{label:"Voltar",class:"mr-2 mb-2",onClick:q},{default:w(()=>e[7]||(e[7]=[a("i",{class:"pi pi-angle-left"},null,-1),ne(" Voltar")])),_:1})]),e[13]||(e[13]=a("div",{class:"font-semibold text-xl"},"Produto",-1)),e[14]||(e[14]=a("small",{class:"p-error"},"Os campos marcados * sao considerados campos obrigatorios.",-1)),a("form",{onSubmit:e[4]||(e[4]=(...t)=>l(D)&&l(D)(...t))},[a("div",xe,[e[8]||(e[8]=a("label",{for:"name1"},"Nome",-1)),i(L,{modelValue:l(B),"onUpdate:modelValue":e[0]||(e[0]=t=>f(B)?B.value=t:null),id:"name",placeholder:"Nome da Produto",class:v({"p-invalid":l(r).name}),type:"text"},null,8,["modelValue","class"]),a("small",ye,g(l(r).name),1)]),a("div",Ve,[e[9]||(e[9]=a("label",{for:"name1"},"Preço",-1)),i(L,{modelValue:l(P),"onUpdate:modelValue":e[1]||(e[1]=t=>f(P)?P.value=t:null),id:"price",placeholder:"Preço",class:v({"p-invalid":l(r).price}),type:"number"},null,8,["modelValue","class"]),a("small",he,g(l(r).price),1)]),a("div",ke,[e[10]||(e[10]=a("label",{for:"name1"},"Categoria",-1)),i(j,{modelValue:l(c),"onUpdate:modelValue":e[2]||(e[2]=t=>f(c)?c.value=t:null),options:F.value,optionLabel:"name",optionValue:"id",placeholder:"Selecionar",class:v({"p-invalid":l(r).category_id})},null,8,["modelValue","options","class"]),a("small",Se,g(l(r).category_id),1)]),a("div",Ce,[e[11]||(e[11]=a("label",{for:"name1"},"SubCategoria",-1)),i(j,{modelValue:l(C),"onUpdate:modelValue":e[3]||(e[3]=t=>f(C)?C.value=t:null),options:S.value,optionLabel:"name",optionValue:"id",placeholder:"Selecionar",class:v({"p-invalid":l(r).sub_category_id})},null,8,["modelValue","options","class"]),a("small",Pe,g(l(r).sub_category_id),1)]),a("div",Be,[e[12]||(e[12]=a("label",{for:"name1"},"Imagem",-1)),i(G,{mode:"basic",name:"image[]",accept:"image/*",auto:"",maxFileSize:1e6,customUpload:"",onUploader:O})]),i(p,{label:"Submeter",class:"mr-2 mb-2",onClick:l(D),disabled:d.value},null,8,["onClick","disabled"]),d.value?(b(),se(E,{key:0,style:{width:"35px",height:"35px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"})):te("",!0)],32)])])])),i(H,{header:"Confirmação",visible:k.value,"onUpdate:visible":e[5]||(e[5]=t=>k.value=t),style:{width:"350px"},modal:!0},{footer:w(()=>[i(p,{label:"Não",icon:"pi pi-times",onClick:z,class:"p-button-text"}),i(p,{label:"Sim",icon:"pi pi-check",onClick:Q,class:"p-button-text",autofocus:""})]),default:w(()=>[e[15]||(e[15]=a("div",{class:"flex align-items-center justify-content-center"},[a("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}}),a("span",null,"Tem certeza que deseja proceder?")],-1))]),_:1},8,["visible"])],64)}}};export{Ke as default};
