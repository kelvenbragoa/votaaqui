import{s as W}from"./index-BiBBGeHC.js";import{s as O}from"./index-gxu_UWez.js";import{s as Q}from"./index-DbDZMwuB.js";import{s as G}from"./index-C1NcMyXW.js";import{x as H,r as l,z as J,o as K,c as C,b as a,d as o,w as V,A as s,B as S,s as w,t as B,C as X,m as Y,F as Z,q as ee,l as c,h as ae}from"./app-DC1UR6pl.js";import{u as le}from"./vee-validate-CXWvnhUn.js";import"./moment-C5S46NFB.js";import{c as se,a as D}from"./index.esm-CQT6nZnd.js";import{d as te}from"./debounce-BMmXVQ06.js";import"./index-Cos-MHlu.js";import"./index-CgS_6hon.js";import"./index-BTmt5xlq.js";const oe={key:0,class:"flex flex-col md:flex-row gap-12 min-h-screen items-center justify-center"},ie={class:"w-full"},re={class:"flex flex-col gap-4 text-center"},ne={key:1,class:"flex flex-col md:flex-row gap-12"},me={class:"w-full"},de={class:"card flex flex-col gap-4"},ce={class:"w-full"},ue={class:"flex flex-col gap-2"},pe={id:"name-help",class:"p-error"},fe={class:"flex flex-col gap-2"},ve={id:"capacity-help",class:"p-error"},ye={class:"flex flex-col gap-2"},xe={id:"monthly_limit-help",class:"p-error"},qe={__name:"CreateTables",setup(be){const u=ee(),n=H();l(null);const p=l(!1),f=l(!1);let $=l(null);const N=l(""),v=l(null),L=l(1);l(15),l(0);const y=l(!1),P=l(null),m=l(!1),U=se({name:D().required().trim().label("Name"),capacity:D().required().trim().label("capacity"),monthly_limit:D().required().trim().label("Monthly Limit")}),{defineField:x,handleSubmit:z,resetForm:ge,errors:r,setErrors:E}=le({validationSchema:U}),[b]=x("name"),[g]=x("capacity"),[h]=x("monthly_limit"),M=l();function q(){u&&u.back()}const F=()=>{y.value=!1},_=z(i=>{M.value!=null&&(i.image=M.value),m.value=!0,axios.post("/api/tables",i,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{u.back(),n.add({severity:"success",summary:"Successo",detail:"Mesa criado com sucesso",life:3e3})}).catch(e=>{m.value=!1,n.add({severity:"error",summary:"Erro}",detail:`${e.response.data.message}`,life:3e3}),e.response.data.errors&&E(e.response.data.errors)}).finally(()=>{m.value=!1})}),j=async(i=1)=>{axios.get("/api/tables/create",{params:{query:N.value}}).then(e=>{v.value=e.data.customer,P.value=e.data.departments,p.value=!1}).catch(e=>{p.value=!1,n.add({severity:"error",summary:`${e}`,detail:"Message Detail",life:3e3}),q()})},A=()=>{f.value=!0,axios.delete(`/api/tables/${$.value}`).then(()=>{v.value.data=v.value.data.filter(i=>i.id!==$.value),F(),n.add({severity:"success",summary:"Sucesso",detail:"Sucesso ao apagar",life:3e3})}).catch(i=>{n.add({severity:"error",summary:"Erro",detail:`${i}`,life:3e3}),f.value=!1}).finally(()=>{f.value=!1})},I=te(()=>{j(L.value)},300);return J(N,I),K(()=>{}),(i,e)=>{const T=G,d=Q,k=O,R=W;return c(),C(Z,null,[p.value?(c(),C("div",oe,[a("div",ie,[a("div",re,[o(T,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"}),e[5]||(e[5]=a("p",null,"Por Favor Aguarde...",-1))])])])):(c(),C("div",ne,[a("div",me,[a("div",de,[a("div",ce,[o(d,{label:"Voltar",class:"mr-2 mb-2",onClick:q},{default:V(()=>e[6]||(e[6]=[a("i",{class:"pi pi-angle-left"},null,-1),ae(" Voltar")])),_:1})]),e[10]||(e[10]=a("div",{class:"font-semibold text-xl"},"Mesa",-1)),e[11]||(e[11]=a("small",{class:"p-error"},"Os campos marcados * sao considerados campos obrigatorios.",-1)),a("form",{onSubmit:e[3]||(e[3]=(...t)=>s(_)&&s(_)(...t))},[a("div",ue,[e[7]||(e[7]=a("label",{for:"name"},"Nome",-1)),o(k,{modelValue:s(b),"onUpdate:modelValue":e[0]||(e[0]=t=>S(b)?b.value=t:null),id:"name",placeholder:"Nome",class:w({"p-invalid":s(r).name}),type:"text"},null,8,["modelValue","class"]),a("small",pe,B(s(r).name),1)]),a("div",fe,[e[8]||(e[8]=a("label",{for:"capacity"},"Capacidade",-1)),o(k,{modelValue:s(g),"onUpdate:modelValue":e[1]||(e[1]=t=>S(g)?g.value=t:null),id:"capacity",placeholder:"Capacidade máxima",class:w({"p-invalid":s(r).capacity}),type:"number"},null,8,["modelValue","class"]),a("small",ve,B(s(r).capacity),1)]),a("div",ye,[e[9]||(e[9]=a("label",{for:"monthly_limit"},"Limite Mensal",-1)),o(k,{modelValue:s(h),"onUpdate:modelValue":e[2]||(e[2]=t=>S(h)?h.value=t:null),id:"monthly_limit",placeholder:"Limite Mensal",class:w({"p-invalid":s(r).monthly_limit}),type:"number"},null,8,["modelValue","class"]),a("small",xe,B(s(r).monthly_limit),1)]),o(d,{label:"Submeter",class:"mr-2 mb-2",onClick:s(_),disabled:m.value},null,8,["onClick","disabled"]),m.value?(c(),X(T,{key:0,style:{width:"35px",height:"35px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"})):Y("",!0)],32)])])])),o(R,{header:"Confirmação",visible:y.value,"onUpdate:visible":e[4]||(e[4]=t=>y.value=t),style:{width:"350px"},modal:!0},{footer:V(()=>[o(d,{label:"Não",icon:"pi pi-times",onClick:F,class:"p-button-text"}),o(d,{label:"Sim",icon:"pi pi-check",onClick:A,class:"p-button-text",autofocus:""})]),default:V(()=>[e[12]||(e[12]=a("div",{class:"flex align-items-center justify-content-center"},[a("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}}),a("span",null,"Tem certeza que deseja proceder?")],-1))]),_:1},8,["visible"])],64)}}};export{qe as default};
