import{s as M}from"./index-CHtFv5iK.js";import{s as T}from"./index-X2KG-qqn.js";import{s as U}from"./index-D3dibykF.js";import{s as J}from"./index-5NlH-buo.js";import{s as O}from"./index-cnl34PeR.js";import{s as W}from"./index-J2AfLYEW.js";import{_ as G,x as H,r as v,y as K,o as Q,c as i,b as e,d as l,h as x,t as p,m as f,w as b,F as C,f as P,l as n,s as j,q as X,j as D}from"./app-DIymDWP7.js";import"./index-BmOqLsRc.js";import"./index-fVX7yaxY.js";import"./index-I1XBC8jC.js";import"./index-BALpCQHV.js";const Y={key:0,class:"flex flex-col md:flex-row gap-12 min-h-screen items-center justify-center"},Z={class:"w-full"},ee={class:"flex flex-col gap-4 text-center"},se={key:1,class:"jury-voting-container"},ae={class:"voting-header"},te={class:"header-content"},oe={key:0,class:"episode-info"},ie={class:"episode-badge"},le={class:"episode-number"},ne={class:"episode-title"},re={class:"voting-status"},ce={key:0,class:"status-alert"},de={class:"participants-grid"},ue={class:"card-image-container"},ve=["src","alt"],pe={key:0,class:"voted-overlay"},me={class:"card-content"},_e={class:"participant-info"},ge={class:"participant-name"},fe={class:"participant-bio"},he={class:"vote-section"},be={key:0,class:"current-score"},ye={class:"score-display"},Ve={key:0,class:"empty-state"},we={key:0,class:"vote-dialog-content"},ke={class:"participant-preview"},xe=["src","alt"],Ce={class:"preview-info"},je={class:"vote-input-section"},De={class:"score-input-container"},Ee={class:"score-indicators"},Se={__name:"Dashboard",setup(Ne){X();const _=H(),y=v(!0),V=v([]),d=v(null),r=v(null),o=v(null),c=v(!1),h=v(!1),w=v(!1),u=K(()=>{if(!d.value)return{active:!1,message:"Nenhum episódio ativo"};if(!d.value.voting_open)return{active:!1,message:"Votação fechada para este episódio"};const t=new Date,s=new Date(d.value.voting_start),m=new Date(d.value.voting_end);return t<s?{active:!1,message:`Votação inicia em ${s.toLocaleDateString()}`}:t>m?{active:!1,message:"Período de votação encerrado"}:{active:!0,message:"Votação ativa"}}),$=async()=>{try{const t=await D.get("/api/votaaqui/episodes/current");d.value=t.data.data}catch(t){console.error("Erro ao buscar episódio atual:",t),_.add({severity:"warn",summary:"Aviso",detail:"Nenhum episódio ativo encontrado",life:3e3})}},E=async()=>{try{const t=await D.get("/api/participants");V.value=t.data.data||t.data}catch(t){console.error("Erro ao carregar participantes:",t),_.add({severity:"error",summary:"Erro",detail:"Erro ao carregar participantes",life:3e3})}},q=t=>{if(!u.value.active){_.add({severity:"warn",summary:"Votação Indisponível",detail:u.value.message,life:3e3});return}r.value=t,o.value=null,h.value=!0},z=async()=>{var t,s;if(!o.value||o.value<1||o.value>10){_.add({severity:"warn",summary:"Voto Inválido",detail:"O voto deve ser entre 1 e 10",life:3e3});return}c.value=!0;try{const m=await D.post("/api/web/judgevotes",{participant_id:r.value.id,episode_id:d.value.id,final_score:o.value});_.add({severity:"success",summary:"Voto Registrado",detail:`Voto ${o.value} para ${r.value.stage_name} registrado com sucesso!`,life:4e3}),h.value=!1,await E()}catch(m){console.error("Erro ao submeter voto:",m);const k=((s=(t=m.response)==null?void 0:t.data)==null?void 0:s.message)||"Erro ao registrar voto";_.add({severity:"error",summary:"Erro",detail:k,life:3e3})}finally{c.value=!1}},R=()=>{h.value=!1,r.value=null,o.value=null},S=()=>{w.value=!1},B=t=>{t.target.src="/votaaqui/assets/img/events/gate1.jpg"},I=async()=>{y.value=!0;try{await Promise.all([$(),E()])}catch(t){console.error("Erro ao inicializar dados:",t)}finally{y.value=!1}};return Q(()=>{I()}),(t,s)=>{const m=W,k=O,A=J,g=U,F=T,N=M;return n(),i(C,null,[y.value?(n(),i("div",Y,[e("div",Z,[e("div",ee,[l(m,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"}),s[3]||(s[3]=e("p",null,"Por Favor Aguarde...",-1))])])])):(n(),i("div",se,[e("div",ae,[e("div",te,[s[4]||(s[4]=e("h1",{class:"header-title"},[e("i",{class:"pi pi-star-fill"}),x(" Painel de Votação do Júri ")],-1)),d.value?(n(),i("div",oe,[e("div",ie,[e("span",le,"Episódio "+p(d.value.episode_number),1),e("span",ne,p(d.value.title),1)]),e("div",re,[l(k,{value:u.value.message,severity:u.value.active?"success":"warn"},null,8,["value","severity"])])])):f("",!0)])]),u.value.active?f("",!0):(n(),i("div",ce,[l(A,{severity:"warn",closable:!1},{default:b(()=>[s[5]||(s[5]=e("i",{class:"pi pi-exclamation-triangle mr-2"},null,-1)),x(" "+p(u.value.message),1)]),_:1})])),e("div",de,[(n(!0),i(C,null,P(V.value,a=>(n(),i("div",{key:a.id,class:j(["participant-card",{voted:a.has_judge_vote}])},[e("div",ue,[e("img",{src:a.photo_url||"/votaaqui/assets/img/events/gate1.jpg",alt:a.name,class:"participant-image",onError:B},null,40,ve),a.has_judge_vote?(n(),i("div",pe,s[6]||(s[6]=[e("i",{class:"pi pi-check-circle"},null,-1),e("span",null,"Votado",-1)]))):f("",!0)]),e("div",me,[e("div",_e,[e("h3",ge,p(a.stage_name||a.name),1),e("p",fe,p(a.biography||"Participante do Reality Show"),1)]),e("div",he,[a.judge_score?(n(),i("div",be,[s[7]||(s[7]=e("span",{class:"score-label"},"Sua nota:",-1)),e("div",ye,p(a.judge_score)+"/10 ",1)])):f("",!0),l(g,{onClick:L=>q(a),label:a.has_judge_vote?"Alterar Voto":"Votar",icon:a.has_judge_vote?"pi pi-pencil":"pi pi-star",class:j(["vote-button",{"p-button-success":!a.has_judge_vote&&u.value.active,"p-button-secondary":a.has_judge_vote,"p-button-help":!u.value.active}]),disabled:!u.value.active},null,8,["onClick","label","icon","class","disabled"])])])],2))),128)),V.value.length===0?(n(),i("div",Ve,s[8]||(s[8]=[e("i",{class:"pi pi-users"},null,-1),e("h3",null,"Nenhum participante encontrado",-1),e("p",null,"Não há participantes disponíveis para votação neste momento.",-1)]))):f("",!0)])])),l(N,{visible:h.value,"onUpdate:visible":s[1]||(s[1]=a=>h.value=a),modal:!0,header:"Registrar Voto",class:"vote-dialog",style:{width:"400px"},closable:!c.value},{footer:b(()=>[l(g,{label:"Cancelar",icon:"pi pi-times",onClick:R,class:"p-button-text",disabled:c.value},null,8,["disabled"]),l(g,{label:c.value?"Registrando...":"Confirmar Voto",icon:c.value?"pi pi-spin pi-spinner":"pi pi-check",onClick:z,disabled:!o.value||c.value,loading:c.value},null,8,["label","icon","disabled","loading"])]),default:b(()=>[r.value?(n(),i("div",we,[e("div",ke,[e("img",{src:r.value.photo_url||"/votaaqui/assets/img/events/gate1.jpg",alt:r.value.name,class:"preview-image"},null,8,xe),e("div",Ce,[e("h4",null,p(r.value.stage_name||r.value.name),1),e("p",null,p(r.value.biography||"Participante do Reality Show"),1)])]),e("div",je,[s[9]||(s[9]=e("label",{for:"voteValue",class:"vote-label"},[e("i",{class:"pi pi-star mr-2"}),x(" Sua nota (1 a 10): ")],-1)),e("div",De,[l(F,{id:"voteValue",modelValue:o.value,"onUpdate:modelValue":s[0]||(s[0]=a=>o.value=a),min:1,max:10,step:1,placeholder:"Digite sua nota",class:"score-input",disabled:c.value},null,8,["modelValue","disabled"]),e("div",Ee,[(n(),i(C,null,P([1,2,3,4,5,6,7,8,9,10],a=>l(g,{key:a,label:a.toString(),onClick:L=>o.value=a,class:j(["score-btn",{"p-button-outlined":o.value!==a}]),size:"small",disabled:c.value},null,8,["label","onClick","class","disabled"])),64))])])])])):f("",!0)]),_:1},8,["visible","closable"]),l(N,{header:"Confirmação",visible:w.value,"onUpdate:visible":s[2]||(s[2]=a=>w.value=a),style:{width:"350px"},modal:!0},{footer:b(()=>[l(g,{label:"Não",icon:"pi pi-times",onClick:S,class:"p-button-text"}),l(g,{label:"Sim",icon:"pi pi-check",onClick:S,class:"p-button-text",autofocus:""})]),default:b(()=>[s[10]||(s[10]=e("div",{class:"flex align-items-center justify-content-center"},[e("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}}),e("span",null,"Tem certeza que deseja proceder?")],-1))]),_:1},8,["visible"])],64)}}},Te=G(Se,[["__scopeId","data-v-01a3a185"]]);export{Te as default};
