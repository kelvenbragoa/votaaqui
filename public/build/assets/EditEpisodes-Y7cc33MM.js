import{s as q}from"./index-Q8Fje-iU.js";import{s as z}from"./index-05wL0Ocg.js";import{s as L}from"./index-DcZdFSdF.js";import{s as M}from"./index-CsuJyiG2.js";import{s as J}from"./index-RMhrKOfx.js";import{s as O}from"./index-DHz7B9uU.js";import{s as R}from"./index-BwT38ftM.js";import{s as W}from"./index-Z6ehlZzN.js";import{s as G}from"./index-BdVJXtgR.js";import{_ as H,x as K,r as f,aP as Q,o as X,c as i,b as s,d as n,e as Y,h as p,s as m,t as c,m as u,j as h,l as d,q as Z,u as ee}from"./app-B8O1oCuU.js";import"./index-BzEFSWDQ.js";import"./index-B9nFa2Qn.js";import"./index-CTH6Yim5.js";import"./index-hQ97aokG.js";import"./index-D30t01VP.js";import"./index-BM4ojN0J.js";import"./index-DMv3sdQS.js";import"./index-BEC1ScWF.js";import"./index-C3-YIMMa.js";import"./index-311MbFo2.js";import"./index-Bx0oxzqV.js";import"./index-BbJxeFEz.js";import"./index-Bb3ejPmB.js";const se={class:"grid"},le={class:"col-12"},te={class:"card"},oe={class:"flex justify-content-between align-items-center mb-4"},ae={key:0,class:"text-center p-4"},ie={class:"grid"},de={class:"col-12 md:col-6"},ne={class:"field"},ue={key:0,class:"p-error"},re={class:"col-12 md:col-6"},pe={class:"field"},me={key:0,class:"p-error"},ce={key:1,class:"text-muted"},ve={class:"col-12"},_e={class:"field"},be={key:0,class:"p-error"},fe={class:"col-12"},ge={class:"field"},ye={key:0,class:"p-error"},we={class:"col-12 md:col-6"},Ve={class:"field"},he={key:0,class:"p-error"},xe={class:"col-12 md:col-6"},ke={class:"field"},je={key:0,class:"p-error"},Ee={class:"col-12"},$e={class:"field-checkbox mb-3"},Pe={key:0,class:"col-12"},Ue={class:"grid"},Se={class:"col-12 md:col-6"},Te={class:"field"},De={key:0,class:"p-error"},Fe={key:1,class:"text-muted"},Ne={class:"col-12 md:col-6"},Ce={class:"field"},Ie={key:0,class:"p-error"},Ae={class:"col-12 md:col-6"},Be={class:"field"},qe={key:0,class:"p-error"},ze={class:"col-12 md:col-6"},Le={class:"field"},Me={key:0,class:"p-error"},Je={key:1,class:"text-muted"},Oe={class:"col-12"},Re={class:"field"},We={class:"col-12"},Ge={class:"field"},He={key:0,class:"p-error"},Ke={class:"col-12"},Qe={class:"flex gap-2 justify-content-end"},Xe={__name:"EditEpisodes",setup(Ye){const x=Z(),k=ee(),g=K(),y=f(!1),j=f(!0),E=f([]),l=f({}),a=f(null),t=f({episode_number:null,title:"",description:"",episode_type:"elimination",air_date:null,status:"scheduled",voting_open:!1,voting_start:null,voting_end:null,jury_weight:50,public_weight:50,participant_ids:[],notes:""}),U=[{label:"Eliminação",value:"elimination"},{label:"Final",value:"finale"},{label:"Especial",value:"special"},{label:"Audição",value:"audition"}],S=[{label:"Agendado",value:"scheduled"},{label:"Ao Vivo",value:"live"},{label:"Finalizado",value:"finished"}],v=Q(()=>a.value&&(a.value.public_votes_count>0||a.value.judge_votes_count>0)),T=async()=>{var r;try{const e=await h.get(`/api/web/episodes/${k.params.id}`);e.data.success&&(a.value=e.data.data,t.value={episode_number:a.value.episode_number,title:a.value.title,description:a.value.description||"",episode_type:a.value.episode_type,air_date:new Date(a.value.air_date),status:a.value.status,voting_open:a.value.voting_open,voting_start:a.value.voting_start?new Date(a.value.voting_start):null,voting_end:a.value.voting_end?new Date(a.value.voting_end):null,jury_weight:a.value.jury_weight,public_weight:a.value.public_weight,participant_ids:((r=a.value.participants)==null?void 0:r.map(_=>_.id))||[],notes:a.value.notes||""})}catch{g.add({severity:"error",summary:"Erro",detail:"Erro ao carregar episódio",life:3e3}),x.push("/admin/episodes")}finally{j.value=!1}},D=async()=>{try{const r=await h.get("/api/web/episodes/participants/available");r.data.success&&(E.value=r.data.data)}catch(r){console.error("Erro ao carregar participantes:",r)}},F=()=>{t.value.jury_weight!==null&&(t.value.public_weight=100-t.value.jury_weight)},N=()=>{t.value.public_weight!==null&&(t.value.jury_weight=100-t.value.public_weight)},C=async()=>{var r,e,_;y.value=!0,l.value={};try{const b=await h.put(`/api/web/episodes/${k.params.id}`,t.value);b.data.success&&(g.add({severity:"success",summary:"Sucesso",detail:b.data.message,life:3e3}),x.push("/admin/episodes"))}catch(b){((r=b.response)==null?void 0:r.status)===422&&(l.value=b.response.data.errors||{}),g.add({severity:"error",summary:"Erro",detail:((_=(e=b.response)==null?void 0:e.data)==null?void 0:_.message)||"Erro ao atualizar episódio",life:3e3})}finally{y.value=!1}};return X(async()=>{await Promise.all([T(),D()])}),(r,e)=>{const _=G,b=W,w=R,$=O,I=J,P=M,V=L,A=z,B=q;return d(),i("div",se,[s("div",le,[s("div",te,[s("div",oe,[e[15]||(e[15]=s("h5",{class:"m-0"},"Editar Episódio",-1)),n(_,{label:"Voltar",icon:"pi pi-arrow-left",class:"p-button-outlined",onClick:e[0]||(e[0]=o=>r.$router.push("/admin/episodes"))})]),j.value?(d(),i("div",ae,[n(b),e[16]||(e[16]=s("p",null,"Carregando dados do episódio...",-1))])):(d(),i("form",{key:1,onSubmit:Y(C,["prevent"])},[s("div",ie,[e[34]||(e[34]=s("div",{class:"col-12"},[s("h6",{class:"text-primary mb-3"},"Informações Básicas")],-1)),s("div",de,[s("div",ne,[e[17]||(e[17]=s("label",{for:"episode_number",class:"block text-900 font-medium mb-2"},[p(" Número do Episódio "),s("span",{class:"text-red-500"},"*")],-1)),n(w,{id:"episode_number",modelValue:t.value.episode_number,"onUpdate:modelValue":e[1]||(e[1]=o=>t.value.episode_number=o),min:1,max:999,showButtons:"",class:m([{"p-invalid":l.value.episode_number},"w-full"])},null,8,["modelValue","class"]),l.value.episode_number?(d(),i("small",ue,c(l.value.episode_number),1)):u("",!0)])]),s("div",re,[s("div",pe,[e[19]||(e[19]=s("label",{for:"episode_type",class:"block text-900 font-medium mb-2"},[p(" Tipo de Episódio "),s("span",{class:"text-red-500"},"*")],-1)),n($,{id:"episode_type",modelValue:t.value.episode_type,"onUpdate:modelValue":e[2]||(e[2]=o=>t.value.episode_type=o),options:U,optionLabel:"label",optionValue:"value",placeholder:"Selecione o tipo",class:m([{"p-invalid":l.value.episode_type},"w-full"]),disabled:v.value},null,8,["modelValue","class","disabled"]),l.value.episode_type?(d(),i("small",me,c(l.value.episode_type),1)):u("",!0),v.value?(d(),i("small",ce,e[18]||(e[18]=[s("i",{class:"pi pi-info-circle"},null,-1),p(" Não é possível alterar o tipo de episódio que já possui votos ")]))):u("",!0)])]),s("div",ve,[s("div",_e,[e[20]||(e[20]=s("label",{for:"title",class:"block text-900 font-medium mb-2"},[p(" Título "),s("span",{class:"text-red-500"},"*")],-1)),n(I,{id:"title",modelValue:t.value.title,"onUpdate:modelValue":e[3]||(e[3]=o=>t.value.title=o),class:m([{"p-invalid":l.value.title},"w-full"]),placeholder:"Ex: Primeira Eliminação"},null,8,["modelValue","class"]),l.value.title?(d(),i("small",be,c(l.value.title),1)):u("",!0)])]),s("div",fe,[s("div",ge,[e[21]||(e[21]=s("label",{for:"description",class:"block text-900 font-medium mb-2"},"Descrição",-1)),n(P,{id:"description",modelValue:t.value.description,"onUpdate:modelValue":e[4]||(e[4]=o=>t.value.description=o),rows:"4",class:m([{"p-invalid":l.value.description},"w-full"]),placeholder:"Descrição do episódio..."},null,8,["modelValue","class"]),l.value.description?(d(),i("small",ye,c(l.value.description),1)):u("",!0)])]),e[35]||(e[35]=s("div",{class:"col-12"},[s("h6",{class:"text-primary mb-3"},"Datas e Status")],-1)),s("div",we,[s("div",Ve,[e[22]||(e[22]=s("label",{for:"air_date",class:"block text-900 font-medium mb-2"},[p(" Data de Transmissão "),s("span",{class:"text-red-500"},"*")],-1)),n(V,{id:"air_date",modelValue:t.value.air_date,"onUpdate:modelValue":e[5]||(e[5]=o=>t.value.air_date=o),showTime:"",hourFormat:"24",class:m([{"p-invalid":l.value.air_date},"w-full"]),placeholder:"dd/mm/aaaa hh:mm",dateFormat:"dd/mm/yy"},null,8,["modelValue","class"]),l.value.air_date?(d(),i("small",he,c(l.value.air_date),1)):u("",!0)])]),s("div",xe,[s("div",ke,[e[23]||(e[23]=s("label",{for:"status",class:"block text-900 font-medium mb-2"},[p(" Status "),s("span",{class:"text-red-500"},"*")],-1)),n($,{id:"status",modelValue:t.value.status,"onUpdate:modelValue":e[6]||(e[6]=o=>t.value.status=o),options:S,optionLabel:"label",optionValue:"value",placeholder:"Selecione o status",class:m([{"p-invalid":l.value.status},"w-full"])},null,8,["modelValue","class"]),l.value.status?(d(),i("small",je,c(l.value.status),1)):u("",!0)])]),e[36]||(e[36]=s("div",{class:"col-12"},[s("h6",{class:"text-primary mb-3"},"Configurações de Votação")],-1)),s("div",Ee,[s("div",$e,[n(A,{id:"voting_open",modelValue:t.value.voting_open,"onUpdate:modelValue":e[7]||(e[7]=o=>t.value.voting_open=o),binary:!0},null,8,["modelValue"]),e[24]||(e[24]=s("label",{for:"voting_open",class:"ml-2"},"Votação Aberta",-1))])]),t.value.voting_open?(d(),i("div",Pe,[s("div",Ue,[s("div",Se,[s("div",Te,[e[26]||(e[26]=s("label",{for:"voting_start",class:"block text-900 font-medium mb-2"},[p(" Início da Votação "),s("span",{class:"text-red-500"},"*")],-1)),n(V,{id:"voting_start",modelValue:t.value.voting_start,"onUpdate:modelValue":e[8]||(e[8]=o=>t.value.voting_start=o),showTime:"",hourFormat:"24",class:m([{"p-invalid":l.value.voting_start},"w-full"]),placeholder:"dd/mm/aaaa hh:mm",dateFormat:"dd/mm/yy",disabled:v.value},null,8,["modelValue","class","disabled"]),l.value.voting_start?(d(),i("small",De,c(l.value.voting_start),1)):u("",!0),v.value?(d(),i("small",Fe,e[25]||(e[25]=[s("i",{class:"pi pi-info-circle"},null,-1),p(" Não é possível alterar datas de votação que já possui votos ")]))):u("",!0)])]),s("div",Ne,[s("div",Ce,[e[27]||(e[27]=s("label",{for:"voting_end",class:"block text-900 font-medium mb-2"},[p(" Fim da Votação "),s("span",{class:"text-red-500"},"*")],-1)),n(V,{id:"voting_end",modelValue:t.value.voting_end,"onUpdate:modelValue":e[9]||(e[9]=o=>t.value.voting_end=o),showTime:"",hourFormat:"24",class:m([{"p-invalid":l.value.voting_end},"w-full"]),placeholder:"dd/mm/aaaa hh:mm",dateFormat:"dd/mm/yy",disabled:v.value},null,8,["modelValue","class","disabled"]),l.value.voting_end?(d(),i("small",Ie,c(l.value.voting_end),1)):u("",!0)])])])])):u("",!0),s("div",Ae,[s("div",Be,[e[28]||(e[28]=s("label",{for:"jury_weight",class:"block text-900 font-medium mb-2"},[p(" Peso do Júri (%) "),s("span",{class:"text-red-500"},"*")],-1)),n(w,{id:"jury_weight",modelValue:t.value.jury_weight,"onUpdate:modelValue":e[10]||(e[10]=o=>t.value.jury_weight=o),min:0,max:100,suffix:"%",class:m([{"p-invalid":l.value.jury_weight},"w-full"]),onInput:F,disabled:v.value},null,8,["modelValue","class","disabled"]),l.value.jury_weight?(d(),i("small",qe,c(l.value.jury_weight),1)):u("",!0)])]),s("div",ze,[s("div",Le,[e[30]||(e[30]=s("label",{for:"public_weight",class:"block text-900 font-medium mb-2"},[p(" Peso Público (%) "),s("span",{class:"text-red-500"},"*")],-1)),n(w,{id:"public_weight",modelValue:t.value.public_weight,"onUpdate:modelValue":e[11]||(e[11]=o=>t.value.public_weight=o),min:0,max:100,suffix:"%",class:m([{"p-invalid":l.value.public_weight},"w-full"]),onInput:N,disabled:v.value},null,8,["modelValue","class","disabled"]),l.value.public_weight?(d(),i("small",Me,c(l.value.public_weight),1)):u("",!0),v.value?(d(),i("small",Je,e[29]||(e[29]=[s("i",{class:"pi pi-info-circle"},null,-1),p(" Não é possível alterar pesos de votação que já possui votos ")]))):u("",!0)])]),e[37]||(e[37]=s("div",{class:"col-12"},[s("h6",{class:"text-primary mb-3"},"Participantes")],-1)),s("div",Oe,[s("div",Re,[e[31]||(e[31]=s("label",{class:"block text-900 font-medium mb-2"},"Selecionar Participantes",-1)),n(B,{modelValue:t.value.participant_ids,"onUpdate:modelValue":e[12]||(e[12]=o=>t.value.participant_ids=o),options:E.value,optionLabel:"name",optionValue:"id",placeholder:"Selecione os participantes",filter:!0,class:"w-full",display:"chip"},null,8,["modelValue","options"]),e[32]||(e[32]=s("small",{class:"text-muted"}," Participantes que irão participar deste episódio ",-1))])]),s("div",We,[s("div",Ge,[e[33]||(e[33]=s("label",{for:"notes",class:"block text-900 font-medium mb-2"},"Notas",-1)),n(P,{id:"notes",modelValue:t.value.notes,"onUpdate:modelValue":e[13]||(e[13]=o=>t.value.notes=o),rows:"3",class:m([{"p-invalid":l.value.notes},"w-full"]),placeholder:"Observações adicionais..."},null,8,["modelValue","class"]),l.value.notes?(d(),i("small",He,c(l.value.notes),1)):u("",!0)])]),s("div",Ke,[s("div",Qe,[n(_,{label:"Cancelar",icon:"pi pi-times",class:"p-button-outlined",onClick:e[14]||(e[14]=o=>r.$router.push("/admin/episodes")),type:"button"}),n(_,{label:"Salvar Alterações",icon:"pi pi-check",type:"submit",loading:y.value},null,8,["loading"])])])])],32))])])])}}},hs=H(Xe,[["__scopeId","data-v-12491a6b"]]);export{hs as default};
