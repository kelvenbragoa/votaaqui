import{s as X}from"./index-CZ0HvYoh.js";import{s as Y}from"./index-lHd1N6GA.js";import{s as Z}from"./index-6eZmd0W_.js";import{s as ee}from"./index-LQiIxZP6.js";import{s as ae}from"./index-BkvNc1Xl.js";import{s as le}from"./index-C0fELCZ3.js";import{x as oe,r as o,y as se,o as te,c as N,b as a,d as i,w as q,z as l,A as v,s as g,t as _,B as ie,m as re,F as ne,q as de,l as S,h as ue}from"./app-Bf6Mdg56.js";import{u as ce}from"./vee-validate-D8sAoENI.js";import"./moment-C5S46NFB.js";import{c as me,a as P}from"./index.esm-CQT6nZnd.js";import{d as pe}from"./debounce-BMmXVQ06.js";import"./index-CU_juRZx.js";import"./index-0kBO3NFd.js";import"./index-DJTbxXZU.js";import"./index-BswoqAwm.js";import"./index-sZHwhbys.js";import"./index-DDFDSg2h.js";import"./index-Cvp8XU8V.js";import"./index-ja5bTmGS.js";import"./index-NwUwLz2D.js";const fe={key:0,class:"flex flex-col md:flex-row gap-12 min-h-screen items-center justify-center"},ve={class:"w-full"},ge={class:"flex flex-col gap-4 text-center"},_e={key:1,class:"flex flex-col md:flex-row gap-12"},be={class:"w-full"},ye={class:"card flex flex-col gap-4"},xe={class:"w-full"},he={class:"flex flex-col gap-2"},Ve={id:"name-help",class:"p-error"},ke={class:"flex flex-col gap-2"},Ce={id:"price-help",class:"p-error"},Se={class:"flex flex-col gap-2"},Pe={id:"buy_price-help",class:"p-error"},$e={class:"flex flex-col gap-2"},we={id:"category_id-help",class:"p-error"},Be={class:"flex flex-col gap-2"},De={id:"sub_category_id-help",class:"p-error"},Ue={class:"flex flex-col gap-2"},Fe={class:"col-6 lg:col-3 xl:col-3"},Ne=["src"],la={__name:"EditProducts",setup(qe){const m=de(),p=oe();o(null);const $=o(!0),w=o(!1);let z=o(null);const A=o(""),n=o(null),I=o(1);o(15),o(0);const B=o(!1),E=o(null),D=o(null),b=o(null),f=o(!1),M=me({category_id:P().required().trim().label("Categoria"),name:P().required().trim().label("Name"),price:P().required().trim().label("Preco"),sub_category_id:P().required().trim().label("Name")}),{defineField:d,handleSubmit:W,resetForm:ze,errors:r,setErrors:O}=ce({validationSchema:M}),[u]=d("category_id"),[y]=d("sub_category_id"),[x]=d("price"),[h]=d("buy_price"),[V]=d("name"),[Q]=d("_method"),c=o();function T(){m&&m.back()}const L=()=>{B.value=!1},U=W(s=>{c.value!=null&&(s.image=c.value),f.value=!0,axios.post(`/api/products/${m.currentRoute.value.params.id}`,s,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{m.back(),p.add({severity:"success",summary:"Successo",detail:"Produto criado com sucesso",life:3e3})}).catch(e=>{f.value=!1,p.add({severity:"error",summary:"Erro}",detail:`${e.response.data.message}`,life:3e3}),e.response.data.errors&&O(e.response.data.errors)}).finally(()=>{f.value=!1})}),R=async(s=1)=>{axios.get(`/api/products/${m.currentRoute.value.params.id}/edit`,{params:{query:A.value}}).then(e=>{n.value=e.data.product,V.value=n.value.name,h.value=n.value.buy_price,x.value=n.value.price,u.value=n.value.category_id,y.value=n.value.sub_category_id,c.value=n.value.image,E.value=e.data.categories,D.value=e.data.sub_categories,b.value=D.value.filter(k=>k.category_id===u.value),Q.value="put",$.value=!1}).catch(e=>{$.value=!1,p.add({severity:"error",summary:`${e}`,detail:"Message Detail",life:3e3}),T()})},G=()=>{w.value=!0,axios.delete(`/api/products/${z.value}`).then(()=>{n.value.data=n.value.data.filter(s=>s.id!==z.value),L(),p.add({severity:"success",summary:"Sucesso",detail:"Sucesso ao apagar",life:3e3})}).catch(s=>{p.add({severity:"error",summary:"Erro",detail:`${s}`,life:3e3}),w.value=!1}).finally(()=>{w.value=!1})},H=s=>{c.value=s.files[0],console.log(c.value)};return pe(()=>{R(I.value)},300),se(u,s=>{s?b.value=D.value.filter(e=>e.category_id===s):b.value=[]}),te(()=>{R()}),(s,e)=>{const k=le,C=ae,F=ee,j=Z,J=Y,K=X;return S(),N(ne,null,[$.value?(S(),N("div",fe,[a("div",ve,[a("div",ge,[i(k,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"}),e[7]||(e[7]=a("p",null,"Por Favor Aguarde...",-1))])])])):(S(),N("div",_e,[a("div",be,[a("div",ye,[a("div",xe,[i(C,{label:"Voltar",class:"mr-2 mb-2",onClick:T},{default:q(()=>e[8]||(e[8]=[a("i",{class:"pi pi-angle-left"},null,-1),ue(" Voltar")])),_:1})]),e[15]||(e[15]=a("div",{class:"font-semibold text-xl"},"Produto",-1)),e[16]||(e[16]=a("small",{class:"p-error"},"Os campos marcados * sao considerados campos obrigatorios.",-1)),a("form",{onSubmit:e[5]||(e[5]=(...t)=>l(U)&&l(U)(...t))},[a("div",he,[e[9]||(e[9]=a("label",{for:"name1"},"Nome",-1)),i(F,{modelValue:l(V),"onUpdate:modelValue":e[0]||(e[0]=t=>v(V)?V.value=t:null),id:"name",placeholder:"Nome da Produto",class:g({"p-invalid":l(r).name}),type:"text"},null,8,["modelValue","class"]),a("small",Ve,_(l(r).name),1)]),a("div",ke,[e[10]||(e[10]=a("label",{for:"name1"},"Preço de Venda",-1)),i(F,{modelValue:l(x),"onUpdate:modelValue":e[1]||(e[1]=t=>v(x)?x.value=t:null),id:"price",placeholder:"Preço de Venda",class:g({"p-invalid":l(r).price}),type:"number"},null,8,["modelValue","class"]),a("small",Ce,_(l(r).price),1)]),a("div",Se,[e[11]||(e[11]=a("label",{for:"buy_price"},"Preço de Compra",-1)),i(F,{modelValue:l(h),"onUpdate:modelValue":e[2]||(e[2]=t=>v(h)?h.value=t:null),id:"buy_price",placeholder:"Preço de Compra",class:g({"p-invalid":l(r).buy_price}),type:"number"},null,8,["modelValue","class"]),a("small",Pe,_(l(r).buy_price),1)]),a("div",$e,[e[12]||(e[12]=a("label",{for:"name1"},"Categoria",-1)),i(j,{modelValue:l(u),"onUpdate:modelValue":e[3]||(e[3]=t=>v(u)?u.value=t:null),options:E.value,optionLabel:"name",optionValue:"id",placeholder:"Selecionar",class:g({"p-invalid":l(r).category_id})},null,8,["modelValue","options","class"]),a("small",we,_(l(r).category_id),1)]),a("div",Be,[e[13]||(e[13]=a("label",{for:"name1"},"SubCategoria",-1)),i(j,{modelValue:l(y),"onUpdate:modelValue":e[4]||(e[4]=t=>v(y)?y.value=t:null),options:b.value,optionLabel:"name",optionValue:"id",placeholder:"Selecionar",class:g({"p-invalid":l(r).sub_category_id})},null,8,["modelValue","options","class"]),a("small",De,_(l(r).sub_category_id),1)]),a("div",Ue,[e[14]||(e[14]=a("label",{for:"name1"},"Imagem",-1)),i(J,{mode:"basic",name:"image[]",accept:"image/*",auto:"",maxFileSize:1e6,customUpload:"",onUploader:H})]),a("div",Fe,[a("img",{src:"/"+c.value,alt:"",weigth:"100",height:"100",style:{"border-radius":"15px"}},null,8,Ne)]),i(C,{label:"Submeter",class:"mr-2 mb-2",onClick:l(U),disabled:f.value},null,8,["onClick","disabled"]),f.value?(S(),ie(k,{key:0,style:{width:"35px",height:"35px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"})):re("",!0)],32)])])])),i(K,{header:"Confirmação",visible:B.value,"onUpdate:visible":e[6]||(e[6]=t=>B.value=t),style:{width:"350px"},modal:!0},{footer:q(()=>[i(C,{label:"Não",icon:"pi pi-times",onClick:L,class:"p-button-text"}),i(C,{label:"Sim",icon:"pi pi-check",onClick:G,class:"p-button-text",autofocus:""})]),default:q(()=>[e[17]||(e[17]=a("div",{class:"flex align-items-center justify-content-center"},[a("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}}),a("span",null,"Tem certeza que deseja proceder?")],-1))]),_:1},8,["visible"])],64)}}};export{la as default};
