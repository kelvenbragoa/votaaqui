import{T as G}from"./index-FVAK9Ojr.js";import{s as J}from"./index-DNDA8ZK3.js";import{s as W}from"./index-CdlkC6XN.js";import{s as X}from"./index-D_nb-Crx.js";import{s as Y}from"./index-D4BDpfsY.js";import{s as Z}from"./index-CZy6Dsa5.js";import{a as ee,s as te}from"./index-CuvYlW7Q.js";import{s as se}from"./index-COQfjwrB.js";import{s as oe}from"./index-DNRZcg5a.js";import{_ as ie,x as ae,r,o as ne,c as I,b as a,d as o,w as n,i as c,F as le,j as D,l as z,z as re,t as m,h as T,s as pe,m as de,q as ue}from"./app-DuMqQ7Hz.js";import{d as ce}from"./debounce-BMmXVQ06.js";import"./index-CfGU8b1Y.js";import"./index-C0fUMy5p.js";import"./index-BBEtc1xv.js";import"./index-Ca51vNO5.js";import"./index-C_lgJNxW.js";import"./index-BfcTpilq.js";import"./index-SFnkIGlv.js";import"./index-rDSFDnia.js";import"./index-RfcOmiDN.js";import"./index-DrRGfUjU.js";import"./index-Ct0xruiZ.js";import"./index-CLZToa9q.js";import"./index-BgovzKEG.js";import"./index-BwE0YRCW.js";import"./index-BAQ1h8Ej.js";import"./index-CB6yOJJj.js";const me={class:"grid"},ve={class:"col-12"},ge={class:"card"},fe={class:"flex justify-content-between align-items-center mb-4"},_e={class:"flex justify-content-between align-items-center mb-4 gap-2"},be={class:"flex align-items-center gap-2"},ye={class:"font-medium"},xe={class:"text-muted"},he={class:"flex align-items-center gap-2"},we={class:"flex align-items-center gap-2"},Ce={class:"flex gap-1"},$e={class:"flex align-items-center justify-content-center"},Ee={key:0},Ve={__name:"IndexEpisodes",setup(ke){const C=ue(),v=ae(),_=r([]),$=r(!1),E=r(!1),b=r(""),y=r(null),g=r(!1),f=r(null),x=r({page:1,per_page:10,total:0,last_page:1}),F=[{label:"Agendado",value:"scheduled"},{label:"Ao Vivo",value:"live"},{label:"Finalizado",value:"finished"}],d=async(s=1)=>{$.value=!0;try{const e={page:s,query:b.value,status:y.value},i=await D.get("/api/web/episodes",{params:e});_.value=i.data.data,x.value={page:i.data.current_page,per_page:i.data.per_page,total:i.data.total,last_page:i.data.last_page}}catch{v.add({severity:"error",summary:"Erro",detail:"Erro ao carregar episódios",life:3e3})}finally{$.value=!1}},S=ce(()=>{d(1)},500),A=s=>{d(s.page+1)},B=()=>{b.value="",y.value=null,d(1)},N=s=>{C.push(`/admin/episodes/${s}`)},j=s=>{C.push(`/admin/episodes/${s}/edit`)},L=s=>{C.push(`/admin/episodes/${s}/stats`)},P=async s=>{var e,i;try{const p=await D.post(`/api/web/episodes/${s.id}/toggle-voting`);if(p.data.success){v.add({severity:"success",summary:"Sucesso",detail:p.data.message,life:3e3});const h=_.value.findIndex(V=>V.id===s.id);h!==-1&&(_.value[h].voting_open=p.data.data.voting_open)}}catch(p){v.add({severity:"error",summary:"Erro",detail:((i=(e=p.response)==null?void 0:e.data)==null?void 0:i.message)||"Erro ao alterar status da votação",life:3e3})}},R=s=>{f.value=s,g.value=!0},q=async()=>{var s,e;E.value=!0;try{const i=await D.delete(`/api/web/episodes/${f.value.id}`);i.data.success&&(v.add({severity:"success",summary:"Sucesso",detail:i.data.message,life:3e3}),g.value=!1,f.value=null,d(x.value.page))}catch(i){v.add({severity:"error",summary:"Erro",detail:((e=(s=i.response)==null?void 0:s.data)==null?void 0:e.message)||"Erro ao excluir episódio",life:3e3})}finally{E.value=!1}},U=s=>s?new Date(s).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",H=s=>({scheduled:"Agendado",live:"Ao Vivo",finished:"Finalizado"})[s]||s,K=s=>({scheduled:"warning",live:"success",finished:"secondary"})[s]||"info";return ne(()=>{d()}),(s,e)=>{const i=oe,p=te,h=se,V=ee,M=Z,k=Y,l=X,O=W,Q=J,u=G;return z(),I(le,null,[a("div",me,[a("div",ve,[a("div",ge,[a("div",fe,[e[5]||(e[5]=a("h5",{class:"m-0"},"Episódios",-1)),o(i,{label:"Novo Episódio",icon:"pi pi-plus",onClick:e[0]||(e[0]=t=>s.$router.push("/admin/episodes/create")),class:"p-button-primary"})]),a("div",_e,[a("div",be,[o(V,{iconPosition:"left"},{default:n(()=>[o(p,{class:"pi pi-search"}),o(h,{modelValue:b.value,"onUpdate:modelValue":e[1]||(e[1]=t=>b.value=t),placeholder:"Buscar episódios...",onInput:re(S)},null,8,["modelValue","onInput"])]),_:1}),o(M,{modelValue:y.value,"onUpdate:modelValue":e[2]||(e[2]=t=>y.value=t),options:F,optionLabel:"label",optionValue:"value",placeholder:"Filtrar por status",showClear:"",onChange:d},null,8,["modelValue"])]),c(o(i,{icon:"pi pi-refresh",onClick:B,class:"p-button-outlined"},null,512),[[u,"Atualizar"]])]),o(O,{value:_.value,lazy:!0,paginator:!0,rows:x.value.per_page,totalRecords:x.value.total,loading:$.value,onPage:A,dataKey:"id",responsiveLayout:"scroll",rowHover:!0},{default:n(()=>[o(l,{field:"episode_number",header:"Nº",sortable:"",style:{"min-width":"80px"}},{body:n(({data:t})=>[o(k,{value:`#${t.episode_number}`,severity:"info"},null,8,["value"])]),_:1}),o(l,{field:"title",header:"Título",sortable:"",style:{"min-width":"200px"}},{body:n(({data:t})=>[a("div",null,[a("div",ye,m(t.title),1),a("small",xe,m(t.episode_type),1)])]),_:1}),o(l,{field:"air_date",header:"Data de Transmissão",sortable:"",style:{"min-width":"150px"}},{body:n(({data:t})=>[T(m(U(t.air_date)),1)]),_:1}),o(l,{field:"status",header:"Status",style:{"min-width":"120px"}},{body:n(({data:t})=>[o(k,{value:H(t.status),severity:K(t.status)},null,8,["value","severity"])]),_:1}),o(l,{field:"voting_open",header:"Votação",style:{"min-width":"100px"}},{body:n(({data:t})=>[o(k,{value:t.voting_open?"Aberta":"Fechada",severity:t.voting_open?"success":"danger"},null,8,["value","severity"])]),_:1}),o(l,{field:"participants_count",header:"Participantes",style:{"min-width":"120px"}},{body:n(({data:t})=>[a("div",he,[e[6]||(e[6]=a("i",{class:"pi pi-users text-primary"},null,-1)),a("span",null,m(t.participants_count||0),1)])]),_:1}),o(l,{field:"public_votes_count",header:"Votos",style:{"min-width":"100px"}},{body:n(({data:t})=>[a("div",we,[e[7]||(e[7]=a("i",{class:"pi pi-heart text-red-500"},null,-1)),a("span",null,m(t.public_votes_count||0),1)])]),_:1}),o(l,{header:"Ações",style:{"min-width":"150px"}},{body:n(({data:t})=>[a("div",Ce,[c(o(i,{icon:"pi pi-eye",class:"p-button-rounded p-button-text p-button-sm",onClick:w=>N(t.id)},null,8,["onClick"]),[[u,"Visualizar"]]),c(o(i,{icon:"pi pi-pencil",class:"p-button-rounded p-button-text p-button-sm",onClick:w=>j(t.id)},null,8,["onClick"]),[[u,"Editar"]]),c(o(i,{icon:t.voting_open?"pi pi-pause":"pi pi-play",class:pe([t.voting_open?"p-button-warning":"p-button-success","p-button-rounded p-button-text p-button-sm"]),onClick:w=>P(t)},null,8,["icon","class","onClick"]),[[u,t.voting_open?"Fechar Votação":"Abrir Votação"]]),c(o(i,{icon:"pi pi-chart-bar",class:"p-button-rounded p-button-text p-button-sm p-button-info",onClick:w=>L(t.id)},null,8,["onClick"]),[[u,"Estatísticas"]]),c(o(i,{icon:"pi pi-trash",class:"p-button-rounded p-button-text p-button-sm p-button-danger",onClick:w=>R(t)},null,8,["onClick"]),[[u,"Excluir"]])])]),_:1})]),_:1},8,["value","rows","totalRecords","loading"])])])]),o(Q,{visible:g.value,"onUpdate:visible":e[4]||(e[4]=t=>g.value=t),style:{width:"450px"},header:"Confirmar Exclusão",modal:!0},{footer:n(()=>[o(i,{label:"Cancelar",icon:"pi pi-times",class:"p-button-text",onClick:e[3]||(e[3]=t=>g.value=!1)}),o(i,{label:"Excluir",icon:"pi pi-check",class:"p-button-danger",onClick:q,loading:E.value},null,8,["loading"])]),default:n(()=>[a("div",$e,[e[12]||(e[12]=a("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),f.value?(z(),I("span",Ee,[e[8]||(e[8]=T(" Tem certeza que deseja excluir o episódio ")),a("b",null,m(f.value.title),1),e[9]||(e[9]=T("? ")),e[10]||(e[10]=a("br",null,null,-1)),e[11]||(e[11]=a("small",{class:"text-muted"},"Esta ação não pode ser desfeita.",-1))])):de("",!0)])]),_:1},8,["visible"])],64)}}},tt=ie(Ve,[["__scopeId","data-v-b046cce6"]]);export{tt as default};
