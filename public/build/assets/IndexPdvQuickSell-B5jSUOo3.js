import{s as le}from"./index-CZ0HvYoh.js";import{s as oe}from"./index-BkvNc1Xl.js";import{s as ie,a as ne,b as re}from"./index-ihPFCC_O.js";import{s as ue,a as de}from"./index-C3WVnDtD.js";import{s as ce}from"./index-CS8QfbGL.js";import{s as pe}from"./index-6eZmd0W_.js";import{s as me}from"./index-C0fELCZ3.js";import{x as ve,r as l,y as fe,o as _e,c as n,b as t,d as i,h as w,t as u,m as C,F as m,f as b,w as r,l as a,B as T,q as be}from"./app-Bf6Mdg56.js";import"./index.esm-CQT6nZnd.js";import"./moment-C5S46NFB.js";import{d as ye}from"./debounce-BMmXVQ06.js";import"./index-CU_juRZx.js";import"./index-0kBO3NFd.js";import"./index-DDFDSg2h.js";import"./index-GOxyKqg5.js";import"./index-EdjGFngG.js";import"./index-l4qq919w.js";import"./index-AjkHMlqC.js";import"./index-DC-ua2C7.js";import"./index-Cvp8XU8V.js";import"./index-ja5bTmGS.js";import"./index-LQiIxZP6.js";import"./index-NwUwLz2D.js";const ge={key:0,class:"flex flex-col md:flex-row gap-12 min-h-screen items-center justify-center"},he={class:"w-full"},xe={class:"flex flex-col gap-4 text-center"},ke={key:1},we={class:"grid grid-cols-12 gap-4 h-screen"},Ce={class:"col-span-12 lg:col-span-3 h-full"},Te={class:"card flex flex-col gap-4 h-full"},qe={key:0},Se=["onClick"],$e={class:"flex justify-between mb-4"},De={key:0,class:"mt-4"},Pe=["disabled"],Be={key:0,class:"flex flex-col gap-4 text-center"},Me={class:"col-span-12 lg:col-span-9"},Ve={class:"mb-2"},je={class:"card flex flex-col gap-4"},Fe={key:0},Ue={class:"grid grid-cols-12 gap-8"},Le={class:"card mb-0 bg-gray-100"},Ie={class:"mb-4"},Ne=["src"],Ee={class:"flex justify-between mb-2"},Re={class:"text-surface-900 dark:text-surface-0 font-medium text-xl"},We={class:"flex justify-between mb-2"},Ae={class:"text-primary font-medium"},ze={class:"flex justify-between mb-2"},Oe=["onClick"],Qe={key:1},He=["src"],gt={__name:"IndexPdvQuickSell",setup(Xe){const q=be(),v=ve();l(null);const S=l(!0),$=l(!1);let F=l(null);const U=l(""),D=l(null),H=l(1);l(15),l(0);const P=l(!1),B=l(null),f=l([]),_=l(0),L=l(0),I=l([]),h=l(!1),x=l(1),k=l(!1),M=l(null),y=l(!1),X=[{label:"Consumo",items:[{label:"Ver consumo",icon:"pi pi-fw pi-folder-open",command:()=>{y.value=!0}},{label:"Imprimir Consumo",icon:"pi pi-fw pi-print",command:()=>{y.value=!0}}]}];function G(){q&&q.back()}const N=()=>{P.value=!1};function J(){const o=document.querySelector("iframe");o&&(o.contentWindow.focus(),o.contentWindow.print())}function K(){k.value=!0,q.back()}function Y(){const o={products:f.value.map(e=>({id:e.id,name:e.name,quantity:e.quantity,total:e.price*e.quantity})),total:_.value,payment_method_id:x.value};h.value=!0,axios.post("/api/pdv/quicksell",o,{headers:{"Content-Type":"multipart/form-data"},responseType:"blob"}).then(e=>{const p=new Blob([e.data],{type:"application/pdf"});M.value=URL.createObjectURL(p),k.value=!0,v.add({severity:"success",summary:"Sucesso",detail:"Produto encomendado com sucesso!",life:3e3})}).catch(e=>{console.log(e),v.add({severity:"error",summary:"Erro",detail:e.response.data.message,life:3e3}),e.response.data.errors&&setErrors(e.response.data.errors)}).finally(()=>{h.value=!1})}function Z(o){const e=f.value.find(V=>V.id===o.id),p=o.quantity_in_principal_stock??0;e?e.quantity<p&&(e.quantity+=1):p>0?f.value.push({...o,quantity:1}):v.add({severity:"error",summary:"Stock Insuficiente",detail:"Produto sem estoque disponível.",life:3e3}),E()}function ee(o){f.value.splice(o,1),E()}function E(){_.value=f.value.reduce((o,e)=>o+e.price*e.quantity,0)}const R=async(o=1)=>{axios.get("/api/pdv/quicksell",{params:{query:U.value}}).then(e=>{D.value=e.data,L.value=e.data.total_consumed,B.value=e.data.categories,I.value=e.data.payment_methods,x.value=1,S.value=!1}).catch(e=>{S.value=!1,v.add({severity:"error",summary:"Erro",detail:`${e.response.data.message}`,life:3e3}),G()})},te=()=>{$.value=!0,axios.delete(`/api/tables/${F.value}`).then(()=>{D.value.data=D.value.data.filter(o=>o.id!==F.value),N(),v.add({severity:"success",summary:"Sucesso",detail:"Sucesso ao apagar",life:3e3})}).catch(o=>{v.add({severity:"error",summary:"Erro",detail:`${o}`,life:3e3}),$.value=!1}).finally(()=>{$.value=!1})},se=ye(()=>{R(H.value)},300);return fe(U,se),_e(()=>{R()}),(o,e)=>{const p=me,V=pe,ae=ce,W=ne,A=re,z=ue,O=de,Q=ie,g=oe,j=le;return a(),n(m,null,[S.value?(a(),n("div",ge,[t("div",he,[t("div",xe,[i(p,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"}),e[5]||(e[5]=t("p",null,"Por Favor Aguarde...",-1))])])])):(a(),n("div",ke,[t("div",we,[t("div",Ce,[t("div",Te,[t("h2",null,[e[6]||(e[6]=w("Resumo da venda ")),_.value>0?(a(),n("div",qe,[t("strong",null,"Total: "+u(_.value)+" MT",1)])):C("",!0)]),(a(!0),n(m,null,b(f.value,(s,d)=>(a(),n("div",{key:d,class:"card bg-gray-100 p-4"},[t("div",null,[t("strong",null,u(s.name),1),t("button",{onClick:c=>ee(d),class:"rounded-full bg-red-100",style:{width:"2.5rem",height:"2.5rem"}},"X",8,Se)]),t("div",$e,[t("div",null,u(s.quantity)+" x "+u(s.price)+" MT",1),t("div",null,u(s.price*s.quantity)+" MT",1)])]))),128)),_.value>0?(a(),n("div",De,[i(V,{modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=s=>x.value=s),options:I.value,optionLabel:"name",optionValue:"id",placeholder:"Selecionar"},null,8,["modelValue","options"]),t("strong",null,"Total: "+u(_.value)+" MT",1),t("button",{disabled:h.value,onClick:Y,class:"bg-blue-500 text-white px-4 py-2 rounded-full mt-1",style:{width:"100%"}},e[7]||(e[7]=[w("Adicionar a conta"),t("i",{class:"pi pi-print"},null,-1)]),8,Pe),h.value?(a(),n("div",Be,[i(p,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"})])):C("",!0)])):C("",!0)])]),t("div",Me,[t("div",Ve,[i(ae,{model:X},{end:r(()=>[t("p",null,"Total Consumo: "+u(L.value)+" MT",1)]),_:1})]),t("div",je,[i(Q,{value:1},{default:r(()=>[i(A,{class:"flex overflow-x-auto space-x-4 pb-2"},{default:r(()=>[(a(!0),n(m,null,b(B.value,s=>(a(),T(W,{key:s.id,value:s.id},{default:r(()=>[w(u(s.name),1)]),_:2},1032,["value"]))),128))]),_:1}),i(O,null,{default:r(()=>[(a(!0),n(m,null,b(B.value,s=>(a(),T(z,{key:s.id,value:s.id},{default:r(()=>[i(Q,{value:0},{default:r(()=>[i(A,{class:"flex overflow-x-auto space-x-4 pb-2"},{default:r(()=>[(a(!0),n(m,null,b(s.sub_categories,d=>(a(),T(W,{key:d.id,value:d.id},{default:r(()=>[w(u(d.name),1)]),_:2},1032,["value"]))),128))]),_:2},1024),i(O,null,{default:r(()=>[(a(!0),n(m,null,b(s.sub_categories,d=>(a(),T(z,{key:d.id,value:d.id},{default:r(()=>[d.products.length>0?(a(),n("div",Fe,[t("div",Ue,[(a(!0),n(m,null,b(d.products,c=>(a(),n("div",{key:c.id,class:"col-span-12 lg:col-span-6 xl:col-span-3"},[t("div",Le,[t("div",Ie,[t("img",{src:c.image?`/${c.image}`:"/image/image.png",alt:"Imagem do Produto",class:"w-full h-32 rounded-t-lg"},null,8,Ne)]),t("div",Ee,[t("div",Re,u(c.name),1)]),t("div",We,[t("span",Ae,"Preço: "+u(c.price)+" MT",1)]),t("div",ze,[t("small",null,"Stock:"+u(c.quantity_in_principal_stock),1)]),t("button",{onClick:Ge=>Z(c),class:"bg-blue-500 text-white px-4 py-2 rounded-full mt-1"}," Adicionar ",8,Oe)])]))),128))])])):(a(),n("div",Qe,e[8]||(e[8]=[t("p",null,"No products available.",-1)])))]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})])])])])),i(j,{header:"Confirmação",visible:P.value,"onUpdate:visible":e[1]||(e[1]=s=>P.value=s),style:{width:"350px"},modal:!0},{footer:r(()=>[i(g,{label:"Não",icon:"pi pi-times",onClick:N,class:"p-button-text"}),i(g,{label:"Sim",icon:"pi pi-check",onClick:te,class:"p-button-text",autofocus:""})]),default:r(()=>[e[9]||(e[9]=t("div",{class:"flex align-items-center justify-content-center"},[t("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}}),t("span",null,"Tem certeza que deseja proceder?")],-1))]),_:1},8,["visible"]),i(j,{header:"Open File",visible:y.value,"onUpdate:visible":e[3]||(e[3]=s=>y.value=s),style:{width:"30vw"}},{default:r(()=>[e[10]||(e[10]=t("p",null,"Here you can manage your files or perform specific actions.",-1)),i(g,{label:"Close",onClick:e[2]||(e[2]=s=>y.value=!1)})]),_:1},8,["visible"]),i(j,{visible:k.value,"onUpdate:visible":e[4]||(e[4]=s=>k.value=s),header:"Recibo",modal:!0,style:{width:"600px"},closable:!1},{footer:r(()=>[i(g,{label:"Imprimir",icon:"pi pi-print",onClick:J}),i(g,{label:"Fechar",icon:"pi pi-times",class:"p-button-text",onClick:K})]),default:r(()=>[M.value?(a(),n("iframe",{key:0,src:M.value,style:{width:"100%",height:"500px"},frameborder:"0"},null,8,He)):C("",!0)]),_:1},8,["visible"])],64)}}};export{gt as default};
