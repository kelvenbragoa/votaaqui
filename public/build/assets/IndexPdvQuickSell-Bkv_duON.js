import{s as K}from"./index-DVuZGizS.js";import{s as Y}from"./index-DYKeWisR.js";import{s as Z,a as ee,b as te}from"./index-BYTwnGt8.js";import{s as se,a as ae}from"./index-BLKD1v9V.js";import{s as le}from"./index-BYntnDHb.js";import{s as oe}from"./index-Cx7ccGKc.js";import{s as ie,r as l,x as ne,o as re,c as o,b as t,d as n,h as y,t as d,m as B,F as m,f as b,w as r,l as s,B as k,q as ue}from"./app-nGuvejiM.js";import{d as de}from"./moment-CQ1ixRO1.js";import"./index-BfWSqF5J.js";import"./index-B8La0_l2.js";import"./index-DhamIECe.js";import"./index-BThpp2Vd.js";import"./index-B7JmaYh8.js";import"./index-CIp4JOxO.js";import"./index-DtcW7-FA.js";import"./index-DYcIN_Hj.js";const ce={key:0,class:"flex flex-col md:flex-row gap-12 min-h-screen items-center justify-center"},pe={class:"w-full"},me={class:"flex flex-col gap-4 text-center"},ve={key:1},fe={class:"grid grid-cols-12 gap-4 h-screen"},_e={class:"col-span-12 lg:col-span-3 h-full"},be={class:"card flex flex-col gap-4 h-full"},ge={key:0},he=["onClick"],xe={class:"flex justify-between mb-4"},ye={key:0,class:"mt-4"},ke=["disabled"],we={key:0,class:"flex flex-col gap-4 text-center"},Ce={class:"col-span-12 lg:col-span-9"},Te={class:"mb-2"},$e={class:"card flex flex-col gap-4"},qe={key:0},De={class:"grid grid-cols-12 gap-8"},Pe={class:"card mb-0 bg-gray-100"},Be={class:"mb-4"},Me=["src"],Se={class:"flex justify-between mb-4"},je={class:"text-surface-900 dark:text-surface-0 font-medium text-xl"},Le={class:"flex justify-between mb-4"},Ue={class:"text-primary font-medium"},Fe=["onClick"],Ne={key:1},st={__name:"IndexPdvQuickSell",setup(Re){const w=ue(),g=ie();l(null);const C=l(!0),T=l(!1);let M=l(null);const S=l(""),$=l(null),O=l(1);l(15),l(0);const q=l(!1),D=l(null),v=l([]),f=l(0),j=l(0),x=l(!1),h=l(!1),z=[{label:"Consumo",items:[{label:"Ver consumo",icon:"pi pi-fw pi-folder-open",command:()=>{h.value=!0}},{label:"Imprimir Consumo",icon:"pi pi-fw pi-print",command:()=>{h.value=!0}}]}];function Q(){w&&w.back()}const L=()=>{q.value=!1};function W(){const i={products:v.value.map(e=>({id:e.id,name:e.name,quantity:e.quantity,total:e.price*e.quantity})),total:f.value};x.value=!0,axios.post("/api/pdv/quicksell",i,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{const c=window.URL.createObjectURL(new Blob([e.data])),p=document.createElement("a");p.href=c,p.setAttribute("download","recibo.pdf"),document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(c),w.back(),loadingprint.value=!1,g.add({severity:"success",summary:"Sucesso",detail:"Produto encomendado com sucesso!",life:3e3})}).catch(e=>{g.add({severity:"error",summary:"Erro",detail:e.response.data.message,life:3e3}),e.response.data.errors&&setErrors(e.response.data.errors)}).finally(()=>{x.value=!1})}function H(i){const e=v.value.find(c=>c.id===i.id);e?e.quantity+=1:v.value.push({...i,quantity:1}),U()}function X(i){v.value.splice(i,1),U()}function U(){f.value=v.value.reduce((i,e)=>i+e.price*e.quantity,0)}const F=async(i=1)=>{axios.get("/api/pdv/quicksell",{params:{query:S.value}}).then(e=>{$.value=e.data,j.value=e.data.total_consumed,D.value=e.data.categories,C.value=!1}).catch(e=>{C.value=!1,g.add({severity:"error",summary:`${e}`,detail:"Message Detail",life:3e3}),Q()})},G=()=>{T.value=!0,axios.delete(`/api/tables/${M.value}`).then(()=>{$.value.data=$.value.data.filter(i=>i.id!==M.value),L(),g.add({severity:"success",summary:"Sucesso",detail:"Sucesso ao apagar",life:3e3})}).catch(i=>{g.add({severity:"error",summary:"Erro",detail:`${i}`,life:3e3}),T.value=!1}).finally(()=>{T.value=!1})},J=de(()=>{F(O.value)},300);return ne(S,J),re(()=>{F()}),(i,e)=>{const c=oe,p=le,N=ee,R=te,E=se,V=ae,A=Z,P=Y,I=K;return s(),o(m,null,[C.value?(s(),o("div",ce,[t("div",pe,[t("div",me,[n(c,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"}),e[3]||(e[3]=t("p",null,"Por Favor Aguarde...",-1))])])])):(s(),o("div",ve,[t("div",fe,[t("div",_e,[t("div",be,[t("h2",null,[e[4]||(e[4]=y("Resumo da venda ")),f.value>0?(s(),o("div",ge,[t("strong",null,"Total: "+d(f.value)+" MT",1)])):B("",!0)]),(s(!0),o(m,null,b(v.value,(a,u)=>(s(),o("div",{key:u,class:"card bg-gray-100 p-4"},[t("div",null,[t("strong",null,d(a.name),1),t("button",{onClick:_=>X(u),class:"rounded-full bg-red-100",style:{width:"2.5rem",height:"2.5rem"}},"X",8,he)]),t("div",xe,[t("div",null,d(a.quantity)+" x "+d(a.price)+" MT",1),t("div",null,d(a.price*a.quantity)+" MT",1)])]))),128)),f.value>0?(s(),o("div",ye,[t("strong",null,"Total: "+d(f.value)+" MT",1),t("button",{disabled:x.value,onClick:W,class:"bg-blue-500 text-white px-4 py-2 rounded-full mt-1",style:{width:"100%"}},e[5]||(e[5]=[y("Adicionar a conta"),t("i",{class:"pi pi-print"},null,-1)]),8,ke),x.value?(s(),o("div",we,[n(c,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"})])):B("",!0)])):B("",!0)])]),t("div",Ce,[t("div",Te,[n(p,{model:z},{end:r(()=>[t("p",null,"Total Consumo: "+d(j.value)+" MT",1)]),_:1})]),t("div",$e,[n(A,{value:1},{default:r(()=>[n(R,{class:"flex overflow-x-auto space-x-4 pb-2"},{default:r(()=>[(s(!0),o(m,null,b(D.value,a=>(s(),k(N,{key:a.id,value:a.id},{default:r(()=>[y(d(a.name),1)]),_:2},1032,["value"]))),128))]),_:1}),n(V,null,{default:r(()=>[(s(!0),o(m,null,b(D.value,a=>(s(),k(E,{key:a.id,value:a.id},{default:r(()=>[n(A,{value:0},{default:r(()=>[n(R,{class:"flex overflow-x-auto space-x-4 pb-2"},{default:r(()=>[(s(!0),o(m,null,b(a.sub_categories,u=>(s(),k(N,{key:u.id,value:u.id},{default:r(()=>[y(d(u.name),1)]),_:2},1032,["value"]))),128))]),_:2},1024),n(V,null,{default:r(()=>[(s(!0),o(m,null,b(a.sub_categories,u=>(s(),k(E,{key:u.id,value:u.id},{default:r(()=>[u.products.length>0?(s(),o("div",qe,[t("div",De,[(s(!0),o(m,null,b(u.products,_=>(s(),o("div",{key:_.id,class:"col-span-12 lg:col-span-6 xl:col-span-3"},[t("div",Pe,[t("div",Be,[t("img",{src:_.image_url||"/image/image.png",alt:"Imagem do Produto",class:"w-full h-32 object-cover rounded-t-lg"},null,8,Me)]),t("div",Se,[t("div",null,[t("div",je,d(_.name),1)])]),t("div",Le,[t("span",Ue,"Preço: "+d(_.price)+" MT",1)]),t("button",{onClick:Ee=>H(_),class:"bg-blue-500 text-white px-4 py-2 rounded-full mt-1"}," Adicionar ",8,Fe)])]))),128))])])):(s(),o("div",Ne,e[6]||(e[6]=[t("p",null,"No products available.",-1)])))]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})])])])])),n(I,{header:"Confirmação",visible:q.value,"onUpdate:visible":e[0]||(e[0]=a=>q.value=a),style:{width:"350px"},modal:!0},{footer:r(()=>[n(P,{label:"Não",icon:"pi pi-times",onClick:L,class:"p-button-text"}),n(P,{label:"Sim",icon:"pi pi-check",onClick:G,class:"p-button-text",autofocus:""})]),default:r(()=>[e[7]||(e[7]=t("div",{class:"flex align-items-center justify-content-center"},[t("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}}),t("span",null,"Tem certeza que deseja proceder?")],-1))]),_:1},8,["visible"]),n(I,{header:"Open File",visible:h.value,"onUpdate:visible":e[2]||(e[2]=a=>h.value=a),style:{width:"30vw"}},{default:r(()=>[e[8]||(e[8]=t("p",null,"Here you can manage your files or perform specific actions.",-1)),n(P,{label:"Close",onClick:e[1]||(e[1]=a=>h.value=!1)})]),_:1},8,["visible"])],64)}}};export{st as default};
